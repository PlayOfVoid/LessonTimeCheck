<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}LearnTimeCheck{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="/static/ico.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/static/ico.ico">
    {% include 'lessons/themes.html' %}
    {% include 'lessons/styles_common.html' %}
</head>
<body class="theme-{{ theme|default:'neon' }}">
    {% if request.session.teacher_id %}
    <nav class="top-navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="{% url 'students_list' %}">üìö LearnTimeCheck</a>
            </div>
            <div class="navbar-right">
                <div class="settings-dropdown">
                    <button class="settings-btn" onclick="toggleSettingsMenu()" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                        ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                    <div class="dropdown-menu" id="settingsDropdown">
                        <a href="{% url 'settings_page' %}?tab=themes" class="dropdown-item">üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                        <a href="{% url 'settings_page' %}?tab=account" class="dropdown-item">üë§ –ê–∫–∫–∞—É–Ω—Ç</a>
                    </div>
                </div>
                <div class="menu-overlay" id="menuOverlay" onclick="toggleSettingsMenu()"></div>
            </div>
        </div>
    </nav>
    {% endif %}
    <div class="main-content">
        {% block content %}{% endblock %}
    </div>

<script>
function toggleSettingsMenu() {
    const dropdown = document.getElementById('settingsDropdown');
    const overlay = document.getElementById('menuOverlay');
    
    dropdown.classList.toggle('active');
    
    if (window.innerWidth <= 768) {
        if (overlay) {
            overlay.classList.toggle('active');
        }
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ
document.getElementById('menuOverlay')?.addEventListener('click', function() {
    toggleSettingsMenu();
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—É–Ω–∫—Ç –º–µ–Ω—é
document.querySelectorAll('.dropdown-item').forEach(item => {
    item.addEventListener('click', function() {
        const dropdown = document.getElementById('settingsDropdown');
        const overlay = document.getElementById('menuOverlay');
        
        setTimeout(() => {
            dropdown.classList.remove('active');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }, 100);
    });
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('settingsDropdown');
    const settingsBtn = document.querySelector('.settings-btn');
    const overlay = document.getElementById('menuOverlay');
    const settingsDropdown = document.querySelector('.settings-dropdown');
    
    if (dropdown && dropdown.classList.contains('active')) {
        if (!settingsDropdown.contains(event.target)) {
            dropdown.classList.remove('active');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }
    }
});
</script>
</body>
</html>

