{% extends "lessons/base.html" %}

{% block title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏{% endblock %}

{% block content %}

<div class="container">
    <div class="header-bar">
        <h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
        <div class="header-actions">
            <a href="{% url 'students_list' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
        </div>
    </div>

    <div class="tabs">
        <a href="?tab=themes" class="tab {% if active_tab == 'themes' %}active{% endif %}">üé® –¢–µ–º—ã</a>
        <a href="?tab=account" class="tab {% if active_tab == 'account' %}active{% endif %}">üë§ –ê–∫–∫–∞—É–Ω—Ç</a>
        <a href="?tab=about" class="tab {% if active_tab == 'about' %}active{% endif %}">‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ</a>
    </div>

    {% if active_tab == 'themes' %}
        <div class="card">
            <h2>üé® –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É</h2>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="change_theme" value="1">
                <div class="theme-selector">
                    <label class="theme-option {% if theme == 'neon' %}active{% endif %}" style="background: linear-gradient(135deg, #0a0a0a, #1a0033); border-color: #8a2be2;">
                        <input type="radio" name="theme" value="neon" {% if theme == 'neon' %}checked{% endif %} style="display: none;">
                        –ù–µ–æ–Ω
                    </label>
                    <label class="theme-option {% if theme == 'ocean' %}active{% endif %}" style="background: linear-gradient(135deg, #001122, #003366); border-color: #00bfff;">
                        <input type="radio" name="theme" value="ocean" {% if theme == 'ocean' %}checked{% endif %} style="display: none;">
                        –û–∫–µ–∞–Ω
                    </label>
                    <label class="theme-option {% if theme == 'forest' %}active{% endif %}" style="background: linear-gradient(135deg, #0a1f0a, #1a3f1a); border-color: #4caf50;">
                        <input type="radio" name="theme" value="forest" {% if theme == 'forest' %}checked{% endif %} style="display: none;">
                        –õ–µ—Å
                    </label>
                    <label class="theme-option {% if theme == 'sunset' %}active{% endif %}" style="background: linear-gradient(135deg, #1a0033, #660033); border-color: #ff5722;">
                        <input type="radio" name="theme" value="sunset" {% if theme == 'sunset' %}checked{% endif %} style="display: none;">
                        –ó–∞–∫–∞—Ç
                    </label>
                    <label class="theme-option {% if theme == 'dark' %}active{% endif %}" style="background: #000000; border-color: #ffffff;">
                        <input type="radio" name="theme" value="dark" {% if theme == 'dark' %}checked{% endif %} style="display: none;">
                        –¢–µ–º–Ω–∞—è
                    </label>
                    <label class="theme-option {% if theme == 'cyber' %}active{% endif %}" style="background: linear-gradient(135deg, #000000, #003300); border-color: #00ff00;">
                        <input type="radio" name="theme" value="cyber" {% if theme == 'cyber' %}checked{% endif %} style="display: none;">
                        –ö–∏–±–µ—Ä
                    </label>
                    <label class="theme-option {% if theme == 'rose' %}active{% endif %}" style="background: linear-gradient(135deg, #1a0a0a, #4a1a2a); border-color: #ec407a;">
                        <input type="radio" name="theme" value="rose" {% if theme == 'rose' %}checked{% endif %} style="display: none;">
                        –†–æ–∑–æ–≤–∞—è
                    </label>
                    <label class="theme-option {% if theme == 'aurora' %}active{% endif %}" style="background: linear-gradient(135deg, #0a0a1a, #1a1a3a); border-color: #40e0d0;">
                        <input type="radio" name="theme" value="aurora" {% if theme == 'aurora' %}checked{% endif %} style="display: none;">
                        –ê–≤—Ä–æ—Ä–∞
                    </label>
                    <label class="theme-option {% if theme == 'minimal' %}active{% endif %}" style="background: #f5f5f5; border-color: #2196f3; color: #333;">
                        <input type="radio" name="theme" value="minimal" {% if theme == 'minimal' %}checked{% endif %} style="display: none;">
                        –ú–∏–Ω–∏–º–∞–ª–∏–∑–º
                    </label>
                    <label class="theme-option {% if theme == 'retro' %}active{% endif %}" style="background: linear-gradient(135deg, #ff6b6b, #4ecdc4); border-color: #2d3436; color: #2d3436;">
                        <input type="radio" name="theme" value="retro" {% if theme == 'retro' %}checked{% endif %} style="display: none;">
                        –†–µ—Ç—Ä–æ
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</button>
            </form>
        </div>
    {% elif active_tab == 'account' %}
        <div class="card">
            <h2>üë§ –ú–æ–∏ –¥–∞–Ω–Ω—ã–µ</h2>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="update_profile" value="1">
                {% if profile_form.errors %}
                    <div class="error">
                        {% for error in profile_form.non_field_errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
                <div class="form-group">
                    <label>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    {{ profile_form.username }}
                    {% if profile_form.username.errors %}
                        <div class="error">{{ profile_form.username.errors }}</div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label>üì± Telegram Chat ID</label>
                    {{ profile_form.telegram_chat_id }}
                    {% if profile_form.telegram_chat_id.help_text %}
                        <small style="display: block; margin-top: 5px; opacity: 0.7;">{{ profile_form.telegram_chat_id.help_text }}</small>
                    {% endif %}
                    {% if profile_form.telegram_chat_id.errors %}
                        <div class="error">{{ profile_form.telegram_chat_id.errors }}</div>
                    {% endif %}
                </div>
                <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </form>
        </div>
        
        <div class="card">
            <h2>üîí –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h2>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="change_password" value="1">
                {% if password_form.errors %}
                    <div class="error">
                        {% for error in password_form.non_field_errors %}
                            <div>{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
                <div class="form-group">
                    <label>üîí –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    {{ password_form.new_password }}
                    {% if password_form.new_password.errors %}
                        <div class="error">{{ password_form.new_password.errors }}</div>
                    {% endif %}
                </div>
                <div class="form-group">
                    <label>üîí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</label>
                    {{ password_form.new_password_confirm }}
                    {% if password_form.new_password_confirm.errors %}
                        <div class="error">{{ password_form.new_password_confirm.errors }}</div>
                    {% endif %}
                </div>
                <button type="submit" class="btn btn-primary">üîí –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </form>
        </div>
        
        <div class="card">
            <h2>ü§ñ Telegram –±–æ—Ç</h2>
            <p>–ù–∞—à Telegram –±–æ—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–Ω—è—Ç–∏—è—Ö.</p>
            <a href="https://t.me/your_bot_username" target="_blank" class="btn btn-primary" style="margin-top: 15px;">–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞</a>
            <p style="margin-top: 10px; opacity: 0.7; font-size: 0.9em;">–£–∫–∞–∂–∏—Ç–µ username –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞</p>
        </div>
    {% elif active_tab == 'about' %}
        <div class="card">
            <h2>‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ</h2>
            <div class="markdown-content">
                {{ about_content|safe }}
            </div>
        </div>
    {% endif %}
</div>

<script>
document.querySelectorAll('.theme-option').forEach(option => {
    option.addEventListener('click', function() {
        document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
        this.querySelector('input[type="radio"]').checked = true;
    });
});
</script>
{% endblock %}

